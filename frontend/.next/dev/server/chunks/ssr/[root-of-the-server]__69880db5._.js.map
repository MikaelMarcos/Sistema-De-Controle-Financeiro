{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 94, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mikae/Documents/ProjetosdeProgramacao/projeto-financeiro/frontend/app/expenses/page.js"],"sourcesContent":["'use client'; \r\n\r\nimport { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst API_URL = 'http://localhost:8000';\r\n\r\n// --- Componente do Formulário de Despesas ---\r\nfunction ExpenseForm({ onExpenseAdded }) {\r\n  const [description, setDescription] = useState('');\r\n  const [amount, setAmount] = useState('');\r\n  const [date, setDate] = useState(''); // Estado para data\r\n  const [categoryId, setCategoryId] = useState('');\r\n  const [categories, setCategories] = useState([]);\r\n\r\n  // Busca categorias\r\n  useEffect(() => {\r\n    axios.get(`${API_URL}/categories/`)\r\n      .then(response => {\r\n        setCategories(response.data);\r\n        if (response.data.length > 0) {\r\n          setCategoryId(response.data[0].id);\r\n        }\r\n      })\r\n      .catch(error => console.error(\"Erro ao buscar categorias:\", error));\r\n  }, []);\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    if (!description || !amount || !categoryId) {\r\n      alert(\"Por favor, preencha todos os campos.\");\r\n      return;\r\n    }\r\n\r\n    const newExpense = {\r\n      description: description,\r\n      amount: parseFloat(amount),\r\n      category_id: parseInt(categoryId),\r\n    };\r\n\r\n    // Adiciona a data ao objeto APENAS se ela foi preenchida\r\n    if (date) {\r\n      newExpense.date = new Date(date).toISOString(); \r\n    }\r\n\r\n    axios.post(`${API_URL}/expenses/`, newExpense)\r\n      .then(response => {\r\n        setDescription('');\r\n        setAmount('');\r\n        setDate(''); // Limpa o campo de data\r\n        onExpenseAdded(response.data); \r\n      })\r\n      .catch(error => console.error(\"Erro ao adicionar despesa:\", error));\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className=\"bg-gray-800 p-6 rounded-lg shadow-lg mb-8\">\r\n      <h2 className=\"text-2xl font-bold mb-4 text-red-400\">Nova Despesa</h2>\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\"> \r\n        <input\r\n          type=\"text\"\r\n          value={description}\r\n          onChange={(e) => setDescription(e.target.value)}\r\n          placeholder=\"Descrição (ex: Almoço)\"\r\n          className=\"p-3 bg-gray-700 rounded border border-gray-600 focus:outline-none focus:border-red-500 md:col-span-2\"\r\n        />\r\n        <input\r\n          type=\"number\"\r\n          value={amount}\r\n          onChange={(e) => setAmount(e.target.value)}\r\n          placeholder=\"Valor (ex: 50.00)\"\r\n          className=\"p-3 bg-gray-700 rounded border border-gray-600 focus:outline-none focus:border-red-500\"\r\n        />\r\n        {/* Campo de Data */}\r\n        <input\r\n          type=\"date\"\r\n          value={date}\r\n          onChange={(e) => setDate(e.target.value)}\r\n          className=\"p-3 bg-gray-700 rounded border border-gray-600 focus:outline-none focus:border-red-500\"\r\n        />\r\n        <select\r\n          value={categoryId}\r\n          onChange={(e) => setCategoryId(e.target.value)}\r\n          className=\"p-3 bg-gray-700 rounded border border-gray-600 focus:outline-none focus:border-red-500 md:col-span-4\"\r\n        >\r\n          <option value=\"\" disabled>Selecione a Categoria</option>\r\n          {categories.map(cat => (\r\n            <option key={cat.id} value={cat.id}>{cat.name}</option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n      <button type=\"submit\" className=\"mt-4 w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded transition duration-300\">\r\n        Adicionar Despesa\r\n      </button>\r\n    </form>\r\n  );\r\n}\r\n\r\n// --- Componente da Lista de Despesas ---\r\nfunction ExpenseList({ expenses, setExpenses }) {\r\n  \r\n  const handleDelete = (id) => {\r\n    if (confirm(\"Tem certeza que deseja deletar esta despesa?\")) {\r\n      axios.delete(`${API_URL}/expenses/${id}`)\r\n        .then(() => {\r\n          setExpenses(expenses.filter(exp => exp.id !== id));\r\n        })\r\n        .catch(error => console.error(\"Erro ao deletar despesa:\", error));\r\n    }\r\n  };\r\n\r\n  // Função para formatar a data\r\n  const formatDate = (dateString) => {\r\n    return new Date(dateString).toLocaleDateString('pt-BR', { timeZone: 'UTC' });\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-gray-800 p-6 rounded-lg shadow-lg\">\r\n      <h2 className=\"text-2xl font-bold mb-4 text-red-400\">Todas as Despesas</h2>\r\n      {expenses.length === 0 ? (\r\n        <p className=\"text-gray-400\">Nenhuma despesa registrada ainda.</p>\r\n      ) : (\r\n        <ul className=\"space-y-4\">\r\n          {expenses.map(expense => (\r\n            <li key={expense.id} className=\"flex justify-between items-center bg-gray-700 p-4 rounded\">\r\n              <div>\r\n                {/* Span de Data */}\r\n                <span className=\"text-xs text-gray-400 block mb-1\">\r\n                  {formatDate(expense.date)}\r\n                </span>\r\n                <span className=\"font-semibold text-lg\">{expense.description}</span>\r\n                <span className={`text-sm ml-2 px-2 py-0.5 rounded ${expense.category ? 'bg-blue-600' : 'bg-gray-600'}`}>\r\n                  {expense.category ? expense.category.name : 'Sem Categoria'}\r\n                </span>\r\n              </div>\r\n              <div className=\"flex items-center space-x-4\">\r\n                <span className=\"font-bold text-red-400 text-lg\">\r\n                  R$ {expense.amount.toFixed(2)}\r\n                </span>\r\n                <button\r\n                  onClick={() => handleDelete(expense.id)}\r\n                  className=\"text-gray-400 hover:text-red-500 transition duration-300\"\r\n                >\r\n                  &times;\r\n                </button>\r\n              </div>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n// --- Componente Principal da Página de Despesas ---\r\nexport default function ExpensesPage() {\r\n  const [expenses, setExpenses] = useState([]);\r\n\r\n  useEffect(() => {\r\n    axios.get(`${API_URL}/expenses/`)\r\n      .then(response => {\r\n        setExpenses(response.data);\r\n      })\r\n      .catch(error => console.error(\"Erro ao buscar despesas:\", error));\r\n  }, []);\r\n\r\n  const handleNewExpense = (newExpense) => {\r\n     // Recarrega a lista inteira para obter dados da categoria\r\n     axios.get(`${API_URL}/expenses/`)\r\n     .then(response => {\r\n       setExpenses(response.data);\r\n     });\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <ExpenseForm onExpenseAdded={handleNewExpense} />\r\n      <ExpenseList expenses={expenses} setExpenses={setExpenses} />\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}