{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 94, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mikae/Documents/ProjetosdeProgramacao/projeto-financeiro/frontend/app/budget/page.js"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst API_URL = 'http://localhost:8000';\r\n\r\n// --- Componente: Banner de Alerta ---\r\nfunction AlertBanner({ overBudgetGroups }) {\r\n  if (overBudgetGroups.length === 0) return null;\r\n\r\n  return (\r\n    <div className=\"bg-gradient-to-r from-red-900/40 to-red-700/30 border-l-4 border-fin-red p-5 mb-8 rounded-xl shadow-lg backdrop-blur-md animate-pulse\">\r\n      <div className=\"flex items-start gap-3\">\r\n        <div className=\"flex-shrink-0\">\r\n          <svg\r\n            className=\"h-7 w-7 text-fin-red animate-bounce\"\r\n            fill=\"none\"\r\n            viewBox=\"0 0 24 24\"\r\n            stroke=\"currentColor\"\r\n          >\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" \r\n              d=\"M12 9v2m0 4h.01M4.93 19h14.14a2 2 0 001.73-3L13.73 4a2 2 0 00-3.46 0L3.2 16a2 2 0 001.73 3z\" />\r\n          </svg>\r\n        </div>\r\n        <div>\r\n          <h3 className=\"text-lg font-bold text-fin-red mb-1\">‚ö†Ô∏è Aten√ß√£o ao Or√ßamento!</h3>\r\n          <p className=\"text-sm text-gray-300\">\r\n            Voc√™ excedeu o limite planejado nos seguintes grupos:\r\n          </p>\r\n          <ul className=\"list-disc list-inside mt-2 text-white font-semibold space-y-1\">\r\n            {overBudgetGroups.map(group => (\r\n              <li key={group.group_id}>\r\n                {group.name} (Estourado em{' '}\r\n                {(group.actual_spent - group.planned_amount).toLocaleString('pt-BR', {\r\n                  style: 'currency',\r\n                  currency: 'BRL',\r\n                })}\r\n                )\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// --- Seletor de M√™s ---\r\nfunction MonthSelector({ currentDate, onDateChange }) {\r\n  const handlePreviousMonth = () => {\r\n    const newDate = new Date(currentDate);\r\n    newDate.setMonth(newDate.getMonth() - 1);\r\n    onDateChange(newDate);\r\n  };\r\n\r\n  const handleNextMonth = () => {\r\n    const newDate = new Date(currentDate);\r\n    newDate.setMonth(newDate.getMonth() + 1);\r\n    onDateChange(newDate);\r\n  };\r\n\r\n  const formattedDate = currentDate\r\n    .toLocaleString('pt-BR', { month: 'long', year: 'numeric' })\r\n    .replace(/^\\w/, (c) => c.toUpperCase());\r\n\r\n  return (\r\n    <div className=\"flex justify-between items-center mb-8 bg-fin-card/30 p-4 rounded-2xl border border-white/5 backdrop-blur-sm shadow-inner\">\r\n      <button\r\n        onClick={handlePreviousMonth}\r\n        className=\"px-3 py-2 text-fin-gold border border-fin-gold/40 rounded-lg hover:bg-fin-gold hover:text-black transition-all\"\r\n      >\r\n        &lt; Anterior\r\n      </button>\r\n      <h2 className=\"text-2xl font-light text-white tracking-wide\">{formattedDate}</h2>\r\n      <button\r\n        onClick={handleNextMonth}\r\n        className=\"px-3 py-2 text-fin-gold border border-fin-gold/40 rounded-lg hover:bg-fin-gold hover:text-black transition-all\"\r\n      >\r\n        Pr√≥ximo &gt;\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function BudgetPage() {\r\n  const [currentDate, setCurrentDate] = useState(new Date());\r\n  const [analysisData, setAnalysisData] = useState(null);\r\n  const [totalPercentage, setTotalPercentage] = useState(0);\r\n  const [overBudgetGroups, setOverBudgetGroups] = useState([]);\r\n\r\n  const fetchAnalysis = async () => {\r\n    const month = currentDate.getMonth() + 1;\r\n    const year = currentDate.getFullYear();\r\n    try {\r\n      const response = await axios.get(`${API_URL}/budget/analysis?month=${month}&year=${year}`);\r\n      setAnalysisData(response.data);\r\n\r\n      const totalPerc = response.data.analysis.reduce(\r\n        (acc, group) => acc + group.target_percentage,\r\n        0\r\n      );\r\n      setTotalPercentage(totalPerc);\r\n\r\n      const alerts = response.data.analysis.filter((group) => group.is_over_budget);\r\n      setOverBudgetGroups(alerts);\r\n    } catch (error) {\r\n      console.error('Erro ao buscar an√°lise de or√ßamento:', error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchAnalysis();\r\n  }, [currentDate]);\r\n\r\n  const handlePercentageChange = (groupId, newValue) => {\r\n    axios\r\n      .put(`${API_URL}/budget/${groupId}?target_percentage=${newValue}`)\r\n      .then(() => fetchAnalysis())\r\n      .catch((error) => console.error('Erro ao atualizar porcentagem:', error));\r\n  };\r\n\r\n  const formatCurrency = (value) =>\r\n    value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });\r\n\r\n  if (!analysisData)\r\n    return (\r\n      <div className=\"text-white flex justify-center items-center h-64 animate-pulse\">\r\n        Carregando an√°lise...\r\n      </div>\r\n    );\r\n\r\n  return (\r\n    <div className=\"text-white\">\r\n      <h1 className=\"text-4xl font-bold mb-8 text-center text-fin-gold tracking-wide drop-shadow-md\">\r\n        üìä Meu Or√ßamento Mensal\r\n      </h1>\r\n\r\n      <MonthSelector currentDate={currentDate} onDateChange={setCurrentDate} />\r\n\r\n      <AlertBanner overBudgetGroups={overBudgetGroups} />\r\n\r\n      {/* Resumo do M√™s */}\r\n      <div className=\"bg-fin-card/80 p-6 rounded-2xl shadow-xl mb-10 flex justify-between items-center border border-white/10 backdrop-blur-md hover:scale-[1.01] transition-all\">\r\n        <div>\r\n          <h2 className=\"text-gray-300 text-sm mb-1 font-medium\">\r\n            Renda em {currentDate.toLocaleString('pt-BR', { month: 'long' })}\r\n          </h2>\r\n          <p className=\"text-4xl font-extrabold text-fin-gold\">{formatCurrency(analysisData.total_income)}</p>\r\n        </div>\r\n        <div className=\"text-right\">\r\n          <h2 className=\"text-gray-300 text-sm mb-1 font-medium\">Planejamento Total</h2>\r\n          <p\r\n            className={`text-3xl font-bold ${\r\n              totalPercentage === 100 ? 'text-green-400' : 'text-fin-red'\r\n            }`}\r\n          >\r\n            {totalPercentage}%\r\n          </p>\r\n          {totalPercentage !== 100 && (\r\n            <span className=\"text-xs text-fin-red block mt-1\">Ajuste para 100%</span>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Lista Comparativa */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n        {analysisData.analysis.map((group) => {\r\n          let spendPercentage = 0;\r\n          if (group.planned_amount > 0) {\r\n            spendPercentage = (group.actual_spent / group.planned_amount) * 100;\r\n          } else if (group.actual_spent > 0) {\r\n            spendPercentage = 100;\r\n          }\r\n          const visualPercentage = Math.min(spendPercentage, 100);\r\n\r\n          return (\r\n            <div\r\n              key={group.group_id}\r\n              className={`p-6 rounded-2xl border transition-all duration-500 hover:scale-[1.02] shadow-lg ${\r\n                group.is_over_budget\r\n                  ? 'bg-gradient-to-br from-red-900/70 to-red-800/50 border-fin-red/40 shadow-red-900/30'\r\n                  : 'bg-gradient-to-br from-fin-dark/70 to-fin-card/40 border-white/10 hover:border-fin-gold/40'\r\n              }`}\r\n            >\r\n              <div className=\"flex justify-between items-start mb-4\">\r\n                <div>\r\n                  <h3 className=\"text-xl font-bold text-white\">{group.name}</h3>\r\n                  <div className=\"flex items-center gap-2 mt-2\">\r\n                    <span className=\"text-sm text-gray-400\">Meta:</span>\r\n                    <input\r\n                      type=\"number\"\r\n                      min=\"0\"\r\n                      max=\"100\"\r\n                      value={group.target_percentage}\r\n                      onChange={(e) =>\r\n                        handlePercentageChange(group.group_id, e.target.value)\r\n                      }\r\n                      className=\"w-16 bg-fin-dark/50 text-center border border-fin-gold/40 rounded-md text-fin-highlight font-bold focus:outline-none focus:border-fin-gold shadow-inner\"\r\n                    />\r\n                    <span className=\"text-fin-highlight\">%</span>\r\n                  </div>\r\n                </div>\r\n                <div className=\"text-right\">\r\n                  <span className=\"text-gray-400 text-xs block uppercase tracking-wider\">\r\n                    Realizado\r\n                  </span>\r\n                  <span\r\n                    className={`text-2xl font-bold ${\r\n                      group.is_over_budget ? 'text-fin-red' : 'text-green-300'\r\n                    }`}\r\n                  >\r\n                    {formatCurrency(group.actual_spent)}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"mb-2\">\r\n                <div className=\"flex justify-between text-xs mb-1\">\r\n                  <span className=\"text-gray-400\">\r\n                    Planejado:{' '}\r\n                    <strong className=\"text-fin-gold\">\r\n                      {formatCurrency(group.planned_amount)}\r\n                    </strong>\r\n                  </span>\r\n                  <span\r\n                    className={`font-semibold ${\r\n                      group.is_over_budget ? 'text-fin-red' : 'text-green-400'\r\n                    }`}\r\n                  >\r\n                    {spendPercentage.toFixed(0)}% gasto\r\n                  </span>\r\n                </div>\r\n                <div className=\"w-full bg-black/30 rounded-full h-4 overflow-hidden border border-white/10 shadow-inner\">\r\n                  <div\r\n                    className={`h-full rounded-full shadow-lg transition-all duration-700 ease-out ${\r\n                      group.is_over_budget\r\n                        ? 'bg-gradient-to-r from-red-500 via-red-600 to-fin-red'\r\n                        : 'bg-gradient-to-r from-green-500 via-green-400 to-green-300'\r\n                    }`}\r\n                    style={{ width: `${visualPercentage}%` }}\r\n                  ></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}