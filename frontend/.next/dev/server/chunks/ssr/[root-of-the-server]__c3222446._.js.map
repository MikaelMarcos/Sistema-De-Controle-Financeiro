{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mikae/Documents/ProjetosdeProgramacao/projeto-financeiro/frontend/app/page.js"],"sourcesContent":["'use client'; \n\nimport { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nconst API_URL = 'https://api-financeiro-vbsl.onrender.com';\n\n// --- Componente: Seletor de Mês ---\nfunction MonthSelector({ currentDate, onDateChange }) {\n  \n  const handlePreviousMonth = () => {\n    const newDate = new Date(currentDate);\n    newDate.setMonth(newDate.getMonth() - 1);\n    onDateChange(newDate);\n  };\n\n  const handleNextMonth = () => {\n    const newDate = new Date(currentDate);\n    newDate.setMonth(newDate.getMonth() + 1);\n    onDateChange(newDate);\n  };\n\n  // Formata a data para \"Novembro de 2025\"\n  const formattedDate = currentDate.toLocaleString('pt-BR', {\n    month: 'long',\n    year: 'numeric',\n  }).replace(/^\\w/, (c) => c.toUpperCase()); // Capitaliza o mês\n\n  return (\n    <div className=\"flex justify-between items-center bg-gray-800 p-4 rounded-lg shadow-lg mb-8\">\n      <button \n        onClick={handlePreviousMonth}\n        className=\"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors\"\n      >\n        &lt; Anterior\n      </button>\n      <h2 className=\"text-xl font-bold text-white\">{formattedDate}</h2>\n      <button \n        onClick={handleNextMonth}\n        className=\"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors\"\n      >\n        Próximo &gt;\n      </button>\n    </div>\n  );\n}\n\n\n// --- Componente: Card de Resumo ---\nfunction SummaryCard({ title, amount, colorClass }) {\n  // Formata o valor para R$ 1.234,56\n  const formattedAmount = amount.toLocaleString('pt-BR', { \n    style: 'currency', \n    currency: 'BRL' \n  });\n  return (\n    <div className={`bg-gray-800 p-6 rounded-lg shadow-lg`}>\n      <h2 className=\"text-sm font-medium text-gray-400 mb-1\">{title}</h2>\n      <p className={`text-3xl font-bold ${colorClass}`}>{formattedAmount}</p>\n    </div>\n  );\n}\n\n// --- Componente da Lista de Despesas ---\nfunction ExpenseList({ expenses, onExpenseDeleted }) {\n  \n  const handleDelete = (id) => {\n    if (confirm(\"Tem certeza que deseja deletar esta despesa?\")) {\n      axios.delete(`${API_URL}/expenses/${id}`)\n        .then(() => {\n          // Notifica o componente pai (Home) que um item foi deletado\n          onExpenseDeleted();\n        })\n        .catch(error => console.error(\"Erro ao deletar despesa:\", error));\n    }\n  };\n\n  // Formata a data para 10/11/2025\n  const formatDate = (dateString) => {\n    return new Date(dateString).toLocaleDateString('pt-BR', { timeZone: 'UTC' });\n  };\n\n  return (\n    <div className=\"bg-gray-800 p-6 rounded-lg shadow-lg\">\n      <h2 className=\"text-2xl font-bold mb-4 text-green-400\">Despesas do Mês</h2>\n      {expenses.length === 0 ? (\n        <p className=\"text-gray-400\">Nenhuma despesa registrada para este mês.</p>\n      ) : (\n        <ul className=\"space-y-4\">\n          {expenses.map(expense => (\n            <li key={expense.id} className=\"flex justify-between items-center bg-gray-700 p-4 rounded\">\n              <div>\n                <span className=\"text-xs text-gray-400 block mb-1\">\n                  {formatDate(expense.date)}\n                </span>\n                <span className=\"font-semibold text-lg\">{expense.description}</span>\n                {/* Mostra a categoria */}\n                <span className={`text-sm ml-2 px-2 py-0.5 rounded ${expense.category ? 'bg-blue-600' : 'bg-gray-600'}`}>\n                  {expense.category ? expense.category.name : 'Sem Categoria'}\n                </span>\n                {/* Mostra a meta se estiver vinculada */}\n                {expense.goal && (\n                   <span className=\"text-sm ml-2 px-2 py-0.5 rounded bg-yellow-600\">\n                    &rarr; {expense.goal.name}\n                  </span>\n                )}\n              </div>\n              <div className=\"flex items-center space-x-4\">\n                <span className=\"font-bold text-red-400 text-lg\">\n                  R$ {expense.amount.toFixed(2)}\n                </span>\n                <button\n                  onClick={() => handleDelete(expense.id)}\n                  className=\"text-gray-400 hover:text-red-500 transition duration-300\"\n                >\n                  &times;\n                </button>\n              </div>\n            </li>\n          ))}\n        </ul>\n      )}\n    </div>\n  );\n}\n\n// --- Componente do Card de Metas ---\nfunction GoalsCard({ goals }) {\n  // Exibe a primeira meta da lista no dashboard\n  const featuredGoal = goals.length > 0 ? goals[0] : null;\n\n  if (!featuredGoal) {\n    return (\n      <div className=\"bg-gray-800 p-6 rounded-lg shadow-lg h-full\">\n        <h2 className=\"text-2xl font-bold mb-4 text-yellow-400\">Suas Metas</h2>\n        <p className=\"text-gray-400\">Nenhuma meta criada. Vá para a página de <a href=\"/metas\" className=\"text-yellow-500 hover:underline\">Metas</a> para criar uma.</p>\n      </div>\n    );\n  }\n\n  // Cálculos de progresso\n  const { name, current_amount, target_amount } = featuredGoal;\n  const progressPercentage = target_amount > 0 \n    ? (current_amount / target_amount) * 100 \n    : 100;\n\n  return (\n    <div className=\"bg-gray-800 p-6 rounded-lg shadow-lg h-full\">\n      <h2 className=\"text-2xl font-bold mb-4 text-yellow-400\">Meta em Destaque</h2>\n      <div>\n        <div className=\"flex justify-between items-center mb-1\">\n          <span className=\"font-semibold text-lg\">{name}</span>\n          <span className=\"text-sm font-medium text-yellow-400\">{progressPercentage.toFixed(1)}%</span>\n        </div>\n        <div className=\"w-full bg-gray-700 rounded-full h-2.5 mb-2\">\n          <div \n            className=\"bg-yellow-500 h-2.5 rounded-full\" \n            style={{ width: `${progressPercentage.toFixed(1)}%` }}\n          ></div>\n        </div>\n        <div className=\"flex justify-between items-center text-sm text-gray-300\">\n          <span>R$ {current_amount.toLocaleString('pt-BR')}</span>\n          <span>R$ {target_amount.toLocaleString('pt-BR')}</span>\n        </div>\n        <a href=\"/metas\" className=\"text-yellow-500 hover:underline text-sm mt-4 inline-block\">\n          Ver todas as metas &rarr;\n        </a>\n      </div>\n    </div>\n  );\n}\n\n\n// --- Componente Principal da Página (Dashboard) ---\nexport default function Home() {\n  const [expenses, setExpenses] = useState([]);\n  const [goals, setGoals] = useState([]);\n  \n  // Estados para os totais\n  const [totalIncome, setTotalIncome] = useState(0);\n  const [totalExpenses, setTotalExpenses] = useState(0);\n  const [balance, setBalance] = useState(0);\n\n  // Estados para o filtro de data e recarregamento\n  const [currentDate, setCurrentDate] = useState(new Date());\n  const [lastUpdate, setLastUpdate] = useState(new Date()); // Para forçar o recarregamento\n\n  // Busca os dados quando a página é carregada ou a data/update muda\n  useEffect(() => {\n    // Esta é a função que o erro mencionava (fetchData)\n    const fetchData = async () => {\n      const month = currentDate.getMonth() + 1; // JS months são 0-indexados\n      const year = currentDate.getFullYear();\n\n      try {\n        // CORREÇÃO: Busca os dados de 3 rotas diferentes,\n        // NÃO da rota /dashboard/summary que não existe.\n        const [expenseRes, incomeRes, goalsRes] = await Promise.all([\n          axios.get(`${API_URL}/expenses/?year=${year}&month=${month}`),\n          axios.get(`${API_URL}/income/?year=${year}&month=${month}`),\n          axios.get(`${API_URL}/goals/`) // Metas não são filtradas por mês\n        ]);\n\n        const expensesData = expenseRes.data;\n        const incomesData = incomeRes.data;\n\n        setExpenses(expensesData);\n        setGoals(goalsRes.data);\n\n        // O frontend calcula os totais\n        const totalInc = incomesData.reduce((acc, income) => acc + income.amount, 0);\n        const totalExp = expensesData.reduce((acc, expense) => acc + expense.amount, 0);\n        \n        setTotalIncome(totalInc);\n        setTotalExpenses(totalExp);\n        setBalance(totalInc - totalExp);\n\n      } catch (error) {\n        // Se o backend estiver desligado, o erro 'Network Error' cairá aqui.\n        console.error(\"Erro ao buscar dados do dashboard:\", error);\n      }\n    };\n\n    fetchData();\n  }, [currentDate, lastUpdate]); // Recarrega se a data mudar ou se um update for forçado\n\n  // Função para forçar o recarregamento (ex: após deletar uma despesa)\n  const handleDataUpdate = () => {\n    setLastUpdate(new Date());\n  };\n\n  return (\n    <div>\n      {/* Seletor de Mês */}\n      <MonthSelector \n        currentDate={currentDate}\n        onDateChange={setCurrentDate}\n      />\n\n      {/* Grid de Resumo */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\n        <SummaryCard \n          title=\"Total Entradas\" \n          amount={totalIncome} \n          colorClass=\"text-green-400\"\n        />\n        <SummaryCard \n          title=\"Total Despesas\" \n          amount={totalExpenses} \n          colorClass=\"text-red-400\"\n        />\n        <SummaryCard \n          title=\"Balanço Atual\" \n          amount={balance} \n          colorClass={balance >= 0 ? \"text-blue-400\" : \"text-red-500\"}\n        />\n      </div>\n\n      {/* Layout em duas colunas: Despesas e Metas */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n        <div className=\"lg:col-span-2\">\n          <ExpenseList \n            expenses={expenses} \n            onExpenseDeleted={handleDataUpdate} // Passa a função de recarregar\n          />\n        </div>\n        <div className=\"lg:col-span-1\">\n          <GoalsCard goals={goals} />\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}