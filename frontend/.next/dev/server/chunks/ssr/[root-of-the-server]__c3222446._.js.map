{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mikae/Documents/ProjetosdeProgramacao/projeto-financeiro/frontend/app/page.js"],"sourcesContent":["'use client'; \n\nimport { useState, useEffect } from 'react';\nimport axios from 'axios';\n// 燥 1. IMPORTAR AS BIBLIOTECAS DE GRﾃ：ICO\nimport { Chart as ChartJS, ArcElement, Tooltip, Legend } from 'chart.js';\nimport { Doughnut } from 'react-chartjs-2';\n\n// 燥 2. REGISTRAR OS COMPONENTES DO GRﾃ：ICO\nChartJS.register(ArcElement, Tooltip, Legend);\n\nconst API_URL = 'http://localhost:8000';\n\n// --- Componente: Seletor de Mﾃｪs (O mesmo de antes) ---\nfunction MonthSelector({ currentDate, onDateChange }) {\n  \n  const handlePreviousMonth = () => {\n    const newDate = new Date(currentDate);\n    newDate.setMonth(newDate.getMonth() - 1);\n    onDateChange(newDate);\n  };\n  const handleNextMonth = () => {\n    const newDate = new Date(currentDate);\n    newDate.setMonth(newDate.getMonth() + 1);\n    onDateChange(newDate);\n  };\n  const formattedDate = currentDate.toLocaleString('pt-BR', {\n    month: 'long',\n    year: 'numeric',\n  }).replace(/^\\w/, (c) => c.toUpperCase());\n\n  return (\n    <div className=\"flex justify-between items-center bg-gray-800 p-4 rounded-lg shadow-lg mb-8\">\n      <button onClick={handlePreviousMonth} className=\"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors\">\n        &lt; Anterior\n      </button>\n      <h2 className=\"text-xl font-bold text-white\">{formattedDate}</h2>\n      <button onClick={handleNextMonth} className=\"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors\">\n        Prﾃｳximo &gt;\n      </button>\n    </div>\n  );\n}\n\n// --- Componente: Card de Resumo (O mesmo de antes, mas com % de poupanﾃｧa) ---\nfunction SummaryCard({ title, amount, colorClass, isCurrency = true }) {\n  const formattedAmount = isCurrency\n    ? amount.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })\n    : `${amount.toFixed(1)}%`; // Formata para porcentagem\n\n  return (\n    <div className={`bg-gray-800 p-6 rounded-lg shadow-lg`}>\n      <h2 className=\"text-sm font-medium text-gray-400 mb-1\">{title}</h2>\n      <p className={`text-3xl font-bold ${colorClass}`}>{formattedAmount}</p>\n    </div>\n  );\n}\n\n// --- NOVO Componente: Grﾃ｡fico de Despesas ---\nfunction ExpenseChart({ chartData }) {\n  \n  // Transforma os dados da API no formato do Chart.js\n  const data = {\n    labels: chartData.map(item => item.category_name),\n    datasets: [\n      {\n        label: 'Gastos por Categoria',\n        data: chartData.map(item => item.total),\n        backgroundColor: [\n          '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0',\n          '#9966FF', '#FF9F40', '#E7E9ED', '#8B0000',\n          '#008B8B', '#BDB76B', '#556B2F', '#FF8C00',\n        ],\n        borderColor: '#4B5563', // bg-gray-600\n        borderWidth: 1,\n      },\n    ],\n  };\n\n  const options = {\n    responsive: true,\n    maintainAspectRatio: false,\n    plugins: {\n      legend: {\n        position: 'right',\n        labels: {\n          color: '#E5E7EB', // text-gray-200\n          boxWidth: 20,\n        }\n      },\n      tooltip: {\n        callbacks: {\n          label: function(context) {\n            let label = context.label || '';\n            if (label) {\n              label += ': ';\n            }\n            if (context.parsed !== null) {\n              label += new Intl.NumberFormat('pt-BR', {\n                style: 'currency',\n                currency: 'BRL',\n              }).format(context.parsed);\n            }\n            return label;\n          }\n        }\n      }\n    },\n  };\n\n  return (\n    <div className=\"bg-gray-800 p-6 rounded-lg shadow-lg h-[400px]\">\n      <h2 className=\"text-2xl font-bold mb-4 text-green-400\">Gastos por Categoria</h2>\n      {chartData.length > 0 ? (\n        <div className=\"relative h-full w-full max-h-[320px]\">\n          <Doughnut data={data} options={options} />\n        </div>\n      ) : (\n        <p className=\"text-gray-400 h-full flex items-center justify-center\">\n          Nenhuma despesa registrada para este mﾃｪs.\n        </p>\n      )}\n    </div>\n  );\n}\n\n// --- Card de Metas (ATUALIZADO com personalizaﾃｧﾃ｣o) ---\nfunction GoalsCard({ goals }) {\n  \n  // 燥 PERSONALIZAﾃﾃグ: Procura a meta \"Casamento\"\n  let featuredGoal = goals.find(g => \n    g.name.toLowerCase().includes('casamento')\n  );\n  // Se nﾃ｣o achar, pega a primeira meta da lista\n  if (!featuredGoal && goals.length > 0) {\n    featuredGoal = goals[0];\n  }\n\n  if (!featuredGoal) {\n    return (\n      <div className=\"bg-gray-800 p-6 rounded-lg shadow-lg h-full\">\n        <h2 className=\"text-2xl font-bold mb-4 text-yellow-400\">Suas Metas</h2>\n        <p className=\"text-gray-400\">Nenhuma meta criada. Vﾃ｡ para a pﾃ｡gina de <a href=\"/metas\" className=\"text-yellow-500 hover:underline\">Metas</a> para criar uma.</p>\n      </div>\n    );\n  }\n\n  // Cﾃ｡lculos\n  const { name, current_amount, target_amount } = featuredGoal;\n  const progressPercentage = target_amount > 0 \n    ? (current_amount / target_amount) * 100 \n    : 100;\n\n  return (\n    <div className=\"bg-gray-800 p-6 rounded-lg shadow-lg h-full\">\n      <h2 className=\"text-2xl font-bold mb-4 text-yellow-400\">Meta em Destaque</h2>\n      <div>\n        <div className=\"flex justify-between items-center mb-1\">\n          <span className=\"font-semibold text-lg\">{name}</span>\n          <span className=\"text-sm font-medium text-yellow-400\">{progressPercentage.toFixed(1)}%</span>\n        </div>\n        <div className=\"w-full bg-gray-700 rounded-full h-2.5 mb-2\">\n          <div className=\"bg-yellow-500 h-2.5 rounded-full\" style={{ width: `${progressPercentage.toFixed(1)}%` }}/>\n        </div>\n        <div className=\"flex justify-between items-center text-sm text-gray-300\">\n          <span>R$ {current_amount.toLocaleString('pt-BR')}</span>\n          <span>R$ {target_amount.toLocaleString('pt-BR')}</span>\n        </div>\n        <a href=\"/metas\" className=\"text-yellow-500 hover:underline text-sm mt-4 inline-block\">\n          Ver todas as metas &rarr;\n        </a>\n      </div>\n    </div>\n  );\n}\n\n\n// --- Componente Principal da Pﾃ｡gina (Dashboard) ---\nexport default function Home() {\n  const [goals, setGoals] = useState([]);\n  \n  // Estado unificado para o resumo do dashboard\n  const [summary, setSummary] = useState({\n    total_income: 0,\n    total_expenses: 0,\n    balance: 0,\n    savings_rate: 0,\n    category_summary: []\n  });\n\n  const [currentDate, setCurrentDate] = useState(new Date());\n  const [lastUpdate, setLastUpdate] = useState(new Date());\n\n  // Busca os dados quando a pﾃ｡gina ﾃｩ carregada ou a data/update muda\n  useEffect(() => {\n    const fetchData = async () => {\n      const month = currentDate.getMonth() + 1;\n      const year = currentDate.getFullYear();\n\n      try {\n        // 燥 REQUISIﾃﾃグ ﾃ哢ICA PARA O RESUMO\n        const summaryRes = await axios.get(\n          `${API_URL}/dashboard/summary?year=${year}&month=${month}`\n        );\n        setSummary(summaryRes.data);\n\n        // Requisiﾃｧﾃ｣o separada para as metas (que nﾃ｣o sﾃ｣o filtradas por mﾃｪs)\n        const goalsRes = await axios.get(`${API_URL}/goals/`);\n        setGoals(goalsRes.data);\n\n      } catch (error) {\n        console.error(\"Erro ao buscar dados do dashboard:\", error);\n      }\n    };\n\n    fetchData();\n  }, [currentDate, lastUpdate]); // Recarrega se a data mudar\n\n\n  return (\n    <div>\n      <MonthSelector \n        currentDate={currentDate}\n        onDateChange={setCurrentDate}\n      />\n\n      {/* 燥 Grid de Resumo ATUALIZADO com 4 cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\n        <SummaryCard \n          title=\"Total Entradas\" \n          amount={summary.total_income} \n          colorClass=\"text-green-400\"\n        />\n        <SummaryCard \n          title=\"Total Despesas\" \n          amount={summary.total_expenses} \n          colorClass=\"text-red-400\"\n        />\n        <SummaryCard \n          title=\"Balanﾃｧo Atual\" \n          amount={summary.balance} \n          colorClass={summary.balance >= 0 ? \"text-blue-400\" : \"text-red-500\"}\n        />\n        {/* 燥 NOVO CARD de Taxa de Poupanﾃｧa */}\n        <SummaryCard \n          title=\"Taxa de Poupanﾃｧa\" \n          amount={summary.savings_rate} \n          colorClass={summary.savings_rate >= 0 ? \"text-green-400\" : \"text-red-500\"}\n          isCurrency={false}\n        />\n      </div>\n\n      {/* Layout em duas colunas: Grﾃ｡fico e Metas */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n        \n        {/* 燥 GRﾃ：ICO (substitui a lista de despesas) */}\n        <div className=\"lg:col-span-2\">\n          <ExpenseChart chartData={summary.category_summary} />\n        </div>\n        \n        <div className=\"lg:col-span-1\">\n          <GoalsCard goals={goals} />\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}