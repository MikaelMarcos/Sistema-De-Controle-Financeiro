{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 94, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mikae/Documents/ProjetosdeProgramacao/projeto-financeiro/frontend/app/page.js"],"sourcesContent":["'use client'; \n\nimport { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nconst API_URL = 'http://localhost:8000';\nconst formatCurrency = (v) => (v ?? 0).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });\n\n// --- Seletor de MÃªs (sem alteraÃ§Ã£o) ---\nfunction MonthSelector({ currentDate, onDateChange }) {\n  const handlePreviousMonth = () => { const newDate = new Date(currentDate); newDate.setMonth(newDate.getMonth() - 1); onDateChange(newDate); };\n  const handleNextMonth = () => { const newDate = new Date(currentDate); newDate.setMonth(newDate.getMonth() + 1); onDateChange(newDate); };\n  const formattedDate = currentDate.toLocaleString('pt-BR', { month: 'long', year: 'numeric' }).replace(/^\\w/, (c) => c.toUpperCase());\n  return (\n    <div className=\"flex justify-between items-center mb-8\"><button onClick={handlePreviousMonth} className=\"p-2 text-fin-gold hover:bg-fin-card rounded-full transition-colors\"><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={2} stroke=\"currentColor\" className=\"w-6 h-6\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15.75 19.5L8.25 12l7.5-7.5\" /></svg></button><h2 className=\"text-3xl font-light text-white tracking-wide\">{formattedDate}</h2><button onClick={handleNextMonth} className=\"p-2 text-fin-gold hover:bg-fin-card rounded-full transition-colors\"><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={2} stroke=\"currentColor\" className=\"w-6 h-6\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M8.25 4.5l7.5 7.5-7.5 7.5\" /></svg></button></div>\n  );\n}\n\n// --- Card de Resumo (sem alteraÃ§Ã£o) ---\nfunction SummaryCard({ title, amount, type }) {\n  const formattedAmount = formatCurrency(amount);\n  let colorClass = \"text-white\";\n  if (type === 'income') colorClass = \"text-fin-gold\";\n  if (type === 'expense') colorClass = \"text-fin-red\";\n  if (type === 'balance') colorClass = amount >= 0 ? \"text-fin-highlight\" : \"text-fin-red\";\n  if (type === 'credit') colorClass = \"text-fin-terra\"; // Cor para Faturas\n  return (\n    <div className=\"bg-fin-card/80 backdrop-blur-sm p-6 rounded-2xl shadow-lg border border-white/5\">\n      <h2 className=\"text-sm font-medium text-gray-300 mb-2 uppercase tracking-wider\">{title}</h2>\n      <p className={`text-3xl font-bold ${colorClass}`}>{formattedAmount}</p>\n    </div>\n  );\n}\n\n// --- Lista de Despesas (sem alteraÃ§Ã£o) ---\nfunction ExpenseList({ expenses, onExpenseDeleted }) {\n  const handleDelete = (id) => { if (confirm(\"Excluir?\")) axios.delete(`${API_URL}/expenses/${id}`).then(() => onExpenseDeleted()); };\n  const formatDate = (d) => new Date(d).toLocaleDateString('pt-BR', { timeZone: 'UTC' });\n  return (\n    <div className=\"bg-fin-card/50 p-6 rounded-2xl border border-white/5\">\n      <h2 className=\"text-xl font-semibold mb-6 text-fin-terra\">Ãšltimas MovimentaÃ§Ãµes (Somente Caixa)</h2>\n      {expenses.length === 0 ? (<p className=\"text-gray-400 font-light italic\">Nenhuma despesa em caixa neste mÃªs.</p>) : (\n        <ul className=\"space-y-3\">\n          {expenses.map(expense => (\n            <li key={expense.id} className=\"flex justify-between items-center bg-fin-dark/40 p-4 rounded-xl hover:bg-fin-dark/60 transition-all border border-white/5\">\n              <div>\n                <span className=\"text-xs text-gray-400\">{formatDate(expense.date)}</span>\n                <span className=\"font-medium text-white block\">{expense.description}</span>\n                <span className=\"text-sm text-fin-gold/80\">{expense.budget_group?.name}</span>\n              </div>\n              <span className=\"font-bold text-fin-red\">- {formatCurrency(expense.amount)}</span>\n            </li>\n          ))}\n        </ul>\n      )}\n    </div>\n  );\n}\n\n// --- Card de Meta (sem alteraÃ§Ã£o) ---\nfunction GoalsCard({ goals }) {\n  const featuredGoal = goals.length > 0 ? goals[0] : null;\n  if (!featuredGoal) return <div className=\"bg-fin-card/50 p-6 rounded-2xl border border-white/5 text-gray-400 h-full\">Sem metas ativas.</div>;\n  const { name, current_amount, target_amount } = featuredGoal;\n  const progress = target_amount > 0 ? (current_amount / target_amount) * 100 : 0;\n  return (\n    <div className=\"bg-gradient-to-br from-fin-card to-fin-dark p-6 rounded-2xl shadow-xl border border-fin-gold/20 h-full relative overflow-hidden\">\n      <div className=\"absolute top-0 right-0 -mt-8 -mr-8 w-32 h-32 bg-fin-gold/10 rounded-full blur-3xl\"></div>\n      <h2 className=\"text-xl font-bold mb-6 text-fin-highlight flex items-center gap-2\">ðŸŽ¯ Foco Principal</h2>\n      <div>\n        <div className=\"flex justify-between items-baseline mb-2\"><span className=\"font-semibold text-2xl text-white\">{name}</span><span className=\"text-lg font-bold text-fin-highlight\">{progress.toFixed(0)}%</span></div>\n        <div className=\"w-full bg-fin-dark rounded-full h-4 mb-4 p-0.5 border border-white/10\"><div className=\"bg-gradient-to-r from-fin-gold to-fin-highlight h-full rounded-full\" style={{ width: `${progress}%` }}></div></div>\n        <div className=\"flex justify-between items-center text-sm text-gray-300\"><span>Atual: <strong className=\"text-white\">{formatCurrency(current_amount)}</strong></span><span>Alvo: <strong className=\"text-white\">{formatCurrency(target_amount)}</strong></span></div>\n      </div>\n    </div>\n  );\n}\n\n// --- Componente Principal (DASHBOARD ATUALIZADO) ---\nexport default function Home() {\n  const [cashExpenses, setCashExpenses] = useState([]); // SÃ³ despesas em dinheiro/dÃ©bito\n  const [goals, setGoals] = useState([]);\n  \n  const [totalIncome, setTotalIncome] = useState(0);\n  const [totalCashExpenses, setTotalCashExpenses] = useState(0);\n  const [totalCreditExpenses, setTotalCreditExpenses] = useState(0); // ðŸ‘ˆ NOVO\n  const [balance, setBalance] = useState(0); // Este serÃ¡ o BalanÃ§o DE CAIXA\n  \n  const [currentDate, setCurrentDate] = useState(new Date());\n  const [lastUpdate, setLastUpdate] = useState(new Date());\n\n  useEffect(() => {\n    const fetchData = async () => {\n      const month = currentDate.getMonth() + 1;\n      const year = currentDate.getFullYear();\n      try {\n        // Busca todas as despesas, todas as receitas, e as metas\n        const [expenseRes, incomeRes, goalsRes] = await Promise.all([\n          axios.get(`${API_URL}/expenses/?year=${year}&month=${month}`),\n          axios.get(`${API_URL}/income/?year=${year}&month=${month}`),\n          axios.get(`${API_URL}/goals/`)\n        ]);\n\n        const allExpenses = expenseRes.data;\n        const allIncomes = incomeRes.data;\n\n        // --- ðŸ‘‡ NOVA LÃ“GICA DE CÃLCULO ðŸ‘‡ ---\n        \n        // 1. Filtra despesas de CAIXA (que afetam o balanÃ§o)\n        const cashOnlyExpenses = allExpenses.filter(exp => !exp.credit_card_id && exp.paid);\n        \n        // 2. Filtra despesas de CRÃ‰DITO (para o card de fatura)\n        // (Apenas as pendentes, ou seja, fatura nÃ£o paga)\n        const creditOnlyExpenses = allExpenses.filter(exp => exp.credit_card_id && !exp.paid);\n        \n        // 3. Filtra receitas de CAIXA (que afetam o balanÃ§o)\n        const receivedIncomes = allIncomes.filter(inc => inc.received);\n\n        // 4. Salva os dados filtrados para a lista\n        setCashExpenses(cashOnlyExpenses);\n        setGoals(goalsRes.data);\n\n        // 5. Calcula os totais\n        const totalInc = receivedIncomes.reduce((acc, i) => acc + i.amount, 0);\n        const totalCashExp = cashOnlyExpenses.reduce((acc, e) => acc + e.amount, 0);\n        const totalCreditExp = creditOnlyExpenses.reduce((acc, e) => acc + e.amount, 0);\n        \n        setTotalIncome(totalInc);\n        setTotalCashExpenses(totalCashExp);\n        setTotalCreditExpenses(totalCreditExp);\n        setBalance(totalInc - totalCashExp); // BalanÃ§o de Caixa\n\n      } catch (error) { console.error(\"Erro:\", error); }\n    };\n    fetchData();\n  }, [currentDate, lastUpdate]);\n\n  return (\n    <div>\n      <MonthSelector currentDate={currentDate} onDateChange={setCurrentDate} />\n      \n      {/* ðŸ‘‡ CARDS DE RESUMO ATUALIZADOS ðŸ‘‡ */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8\">\n        <SummaryCard title=\"Receita (em Caixa)\" amount={totalIncome} type=\"income\" />\n        <SummaryCard title=\"Despesas (em Caixa)\" amount={totalCashExpenses} type=\"expense\" />\n        <SummaryCard title=\"BalanÃ§o de Caixa\" amount={balance} type=\"balance\" />\n        <SummaryCard title=\"Faturas Abertas (CrÃ©dito)\" amount={totalCreditExpenses} type=\"credit\" />\n      </div>\n      \n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n        <div className=\"lg:col-span-2\">\n          {/* A lista agora sÃ³ mostra despesas de caixa */}\n          <ExpenseList expenses={cashExpenses} onExpenseDeleted={() => setLastUpdate(new Date())} />\n        </div>\n        <div className=\"lg:col-span-1\">\n          <GoalsCard goals={goals} />\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}